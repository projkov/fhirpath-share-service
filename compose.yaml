services:
  nginx:
    image: jonasal/nginx-certbot:latest
    ports:
    - "80:80"
    - "443:443"
    volumes:
    - ./nginx:/etc/nginx/user_conf.d:ro
    - ./letsencrypt:/etc/letsencrypt
    environment:
      CERTBOT_EMAIL: prozskov@gmail.com
    depends_on:
      - frontend
      - backend
      - sage
  backend:
    image: ghcr.io/projkov/fhirpath-py-as-service:3581447a60e2e6803b940f0ad025f3ff460dcc0f
    ports:
    - '5000:5000'
  frontend:
    image: ghcr.io/projkov/fhirpath-ui:e60b8c30477e331325f569fe58167467f2037de0
    env_file:
      - .env
    ports:
    - '3000:80'
  sage:
    image: ghcr.io/projkov/sage:c8d670b58e39caf38fd42d1f72cbcb390c862e6e
    env_file:
      - .env-sage
    ports:
    - '3001:3000'
    command: yarn start
